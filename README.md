# mit6.824
2021 mit-6.824实验 无锁版

只完成了 lab2 raft和lab3 KVServer。

raft部分突发奇想，结合了部分consul的raft的实现，实现了一个只用chan，atomic的，无锁版本的raft（当然lab3部分还是有锁的。。。）。
部分实现很丑陋，看测试能过了也不想优化了😄

在cpu没跑满的情况下，lab2，lab3测试（除了Speed测试）跑了100000次，没发现错误（cpu如果跑满，可能部分test因为超时失败）---
除了3A和3B的两个Speed测试，这里属实有点坑。。当我raft（lab2）写完，写到3A的时候发现，3A的测试需要leader appendEntry之后立刻同步一次心跳，否则Speed测试过不了。。
但是当时我已经把lab2跑了100000次了。。实在是不想改了再等测完再写lab3。于是我暴力的直接在每次appendEntry，每次leader更新commitIdx后，强行同步心跳，测试了一下，两个测试通过是绰绰有余的。

个人认为这个实验最关键的是让几个关键的rpc幂等，也就是即使某个rpc（或者说是网络层的某个包）发生乱序、重复、不可送达、超时很久很久送达，也应该保证可靠。

如果有问题，或者发现了bug，欢迎一起交流～
